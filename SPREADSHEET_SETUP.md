# Spreadsheet セットアップ手順

## 手順1: Spreadsheetを作成

1. Google Driveにアクセス
2. 「新規」→「Google スプレッドシート」→「空白のスプレッドシート」
3. ファイル名を「**保護者メール登録システム_データベース**」に変更

## 手順2: GASエディタを開く

1. スプレッドシートのメニューから「拡張機能」→「Apps Script」を選択
2. GASエディタが開きます

## 手順3: 初期化スクリプトを実行

### 方法A: 自動初期化（推奨）

1. GASエディタで新しいファイル `InitializeSheet.gs` を作成
2. `src/backend/InitializeSheet.gs` の内容をコピー＆ペースト
3. 関数 `initializeSpreadsheet` を実行
4. 初回実行時、権限の承認を求められるので承認
5. 実行完了後、スプレッドシートに戻って確認

### 方法B: 手動作成

1. スプレッドシート下部の「+」ボタンで3つのシートを作成
2. シート名を以下に変更：
   - `世帯マスタ`
   - `保護者`
   - `生徒`
3. 各シートの1行目に以下のヘッダーを入力

**世帯マスタシート（A1:L1）：**
```
世帯登録番号 | 基幹世帯ID | 登録日時 | 最終更新日時 | 編集コード | ご自宅郵便番号 | ご自宅都道府県 | ご自宅市区町村 | ご自宅町名・番地・号 | ご自宅建物名・部屋番号 | 備考 | 連携ステータス
```

**保護者シート（A1:O1）：**
```
世帯登録番号 | 保護者登録番号 | 基幹保護者ID | 続柄 | 続柄その他詳細 | 連絡優先順位 | 連絡手段 | 姓 | 名 | フリガナ姓 | フリガナ名 | 連絡用メール | オンライン面談用メール | 携帯電話番号 | 自宅電話番号
```

**生徒シート（A1:Q1）：**
```
世帯登録番号 | 生徒登録番号 | 基幹生徒ID | 姓 | 名 | フリガナ姓 | フリガナ名 | 高校卒業予定年 | 連絡用メール | オンライン授業用メール | 携帯電話番号 | 住所フラグ | 生徒郵便番号 | 生徒都道府県 | 生徒市区町村 | 生徒町名・番地・号 | 生徒建物名・部屋番号
```

## 手順4: Spreadsheet IDを取得

1. スプレッドシートのURLを確認
   ```
   https://docs.google.com/spreadsheets/d/【ここがSpreadsheet ID】/edit
   ```
2. `/d/` と `/edit` の間の文字列（長い英数字）をコピー
3. このIDを控えておく

## 完了！

Spreadsheet IDを教えていただければ、続きの実装に進めます。
