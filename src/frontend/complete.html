<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç™»éŒ²å®Œäº†</title>
  <?!= include('css/style'); ?>
</head>

<body>
  <div class="container">
    <header>
      <h1>âœ… ç™»éŒ²å®Œäº†</h1>
      <p class="subtitle">ã”ç™»éŒ²ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸ</p>
    </header>

    <main>
      <section class="form-section success-section">
        <div class="success-icon">
          <svg width="80" height="80" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="12" cy="12" r="10" stroke="#50C878" stroke-width="2" />
            <path d="M8 12L11 15L16 9" stroke="#50C878" stroke-width="2" stroke-linecap="round" />
          </svg>
        </div>

        <h2>ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸ</h2>

        <div class="alert alert-info">
          <p><strong>ç¢ºèªãƒ¡ãƒ¼ãƒ«ã‚’é€ä¿¡ã—ã¾ã—ãŸ</strong></p>
          <p>ç™»éŒ²ã•ã‚ŒãŸãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹å®›ã«ç¢ºèªãƒ¡ãƒ¼ãƒ«ã‚’ãŠé€ã‚Šã—ã¾ã—ãŸã€‚</p>
          <p>ãƒ¡ãƒ¼ãƒ«ãŒå±Šã‹ãªã„å ´åˆã¯ã€è¿·æƒ‘ãƒ¡ãƒ¼ãƒ«ãƒ•ã‚©ãƒ«ãƒ€ã‚’ã”ç¢ºèªãã ã•ã„ã€‚</p>
        </div>

        <!-- ç·¨é›†ã‚³ãƒ¼ãƒ‰è¡¨ç¤º -->
        <div class="edit-code-box">
          <h3>ğŸ“ ç·¨é›†ã‚³ãƒ¼ãƒ‰</h3>
          <p class="edit-code-description">
            ç™»éŒ²å†…å®¹ã‚’å¤‰æ›´ã™ã‚‹éš›ã«å¿…è¦ã§ã™ã€‚å¤§åˆ‡ã«ä¿ç®¡ã—ã¦ãã ã•ã„ã€‚
          </p>
          <div class="edit-code">
            <?= editCode ?>
          </div>
          <button type="button" class="btn btn-secondary btn-sm mt-2" onclick="copyEditCode()">
            ğŸ“‹ ã‚³ãƒ”ãƒ¼ã™ã‚‹
          </button>
        </div>

        <!-- ç™»éŒ²å†…å®¹ã‚µãƒãƒªãƒ¼ -->
        <div class="summary-box">
          <h3>ğŸ“‹ ç™»éŒ²å†…å®¹</h3>
          <div class="summary-item">
            <strong>ä¿è­·è€…:</strong>
            <? guardians.forEach((g, i) => { ?>
            <?= i > 0 ? 'ã€' : '' ?>
            <?= g.lastName ?>
            <?= g.firstName ?>æ§˜ï¼ˆ
            <?= g.relationship ?>ï¼‰
            <? }); ?>
          </div>
          <div class="summary-item">
            <strong>ç”Ÿå¾’:</strong>
            <? students.forEach((s, i) => { ?>
            <?= i > 0 ? 'ã€' : '' ?>
            <?= s.lastName ?>
            <?= s.firstName ?>æ§˜ï¼ˆ
            <?= s.graduationYear ?>å¹´å’æ¥­äºˆå®šï¼‰
            <? }); ?>
          </div>
        </div>

        <!-- æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ— -->
        <div class="next-steps">
          <h3>ğŸ“Œ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h3>
          <ol>
            <li>ç¢ºèªãƒ¡ãƒ¼ãƒ«ãŒå±Šã„ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„</li>
            <li>ç·¨é›†ã‚³ãƒ¼ãƒ‰ã‚’å®‰å…¨ãªå ´æ‰€ã«ä¿ç®¡ã—ã¦ãã ã•ã„</li>
            <li>ç™»éŒ²å†…å®¹ã«å¤‰æ›´ãŒã‚ã‚‹å ´åˆã¯ã€ç·¨é›†ã‚³ãƒ¼ãƒ‰ã‚’ä½¿ã£ã¦ä¿®æ­£ã§ãã¾ã™</li>
          </ol>
        </div>

        <!-- ãŠå•ã„åˆã‚ã› -->
        <div class="contact-box">
          <p>ã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ä»¥ä¸‹ã¾ã§ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚</p>
          <p><strong>
              <?= config.adminEmail ?>
            </strong></p>
        </div>
      </section>
    </main>
  </div>

  <script>
    function copyEditCode() {
      const editCode = '<?= editCode ?>';

      if (navigator.clipboard) {
        navigator.clipboard.writeText(editCode).then(function () {
          alert('ç·¨é›†ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ');
        }).catch(function () {
          fallbackCopy(editCode);
        });
      } else {
        fallbackCopy(editCode);
      }
    }

    function fallbackCopy(text) {
      const textarea = document.createElement('textarea');
      textarea.value = text;
      textarea.style.position = 'fixed';
      textarea.style.opacity = '0';
      document.body.appendChild(textarea);
      textarea.select();

      try {
        document.execCommand('copy');
        alert('ç·¨é›†ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ');
      } catch (err) {
        alert('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚');
      }

      document.body.removeChild(textarea);
    }
  </script>

  <style>
    .success-section {
      text-align: center;
    }

    .success-icon {
      margin: 20px 0;
      animation: scaleIn 0.5s ease-out;
    }

    @keyframes scaleIn {
      from {
        transform: scale(0);
        opacity: 0;
      }

      to {
        transform: scale(1);
        opacity: 1;
      }
    }

    .edit-code-box {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      border-radius: var(--radius);
      margin: 30px 0;
    }

    .edit-code-box h3 {
      color: white;
      margin-bottom: 10px;
    }

    .edit-code-description {
      margin-bottom: 15px;
      opacity: 0.95;
    }

    .edit-code {
      background: white;
      color: var(--text-color);
      font-size: 2rem;
      font-weight: bold;
      letter-spacing: 0.3em;
      padding: 20px;
      border-radius: var(--radius);
      margin: 15px 0;
      font-family: 'Courier New', monospace;
    }

    .summary-box {
      background: var(--bg-light);
      padding: 20px;
      border-radius: var(--radius);
      text-align: left;
      margin: 20px 0;
    }

    .summary-box h3 {
      color: var(--primary-color);
      margin-bottom: 15px;
    }

    .summary-item {
      margin: 10px 0;
      line-height: 1.8;
    }

    .next-steps {
      text-align: left;
      background: white;
      padding: 20px;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      margin: 20px 0;
    }

    .next-steps h3 {
      color: var(--primary-color);
      margin-bottom: 15px;
    }

    .next-steps ol {
      padding-left: 25px;
    }

    .next-steps li {
      margin: 10px 0;
      line-height: 1.6;
    }

    .contact-box {
      margin-top: 30px;
      padding: 20px;
      background: #fff3cd;
      border-left: 4px solid #ffc107;
      border-radius: var(--radius);
    }

    @media (max-width: 768px) {
      .edit-code {
        font-size: 1.5rem;
        letter-spacing: 0.2em;
      }
    }
  </style>
</body>

</html>